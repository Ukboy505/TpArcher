const _0x3c1ac2=_0x3267;(function(_0x17d3e5,_0x42825c){const _0x3c5342=_0x3267,_0x305980=_0x17d3e5();while(!![]){try{const _0xd76f51=-parseInt(_0x3c5342(0xc1))/0x1+-parseInt(_0x3c5342(0xaf))/0x2*(parseInt(_0x3c5342(0xba))/0x3)+parseInt(_0x3c5342(0xd0))/0x4*(parseInt(_0x3c5342(0xd6))/0x5)+-parseInt(_0x3c5342(0xa3))/0x6+-parseInt(_0x3c5342(0xb6))/0x7*(parseInt(_0x3c5342(0xa1))/0x8)+parseInt(_0x3c5342(0xad))/0x9*(parseInt(_0x3c5342(0xb9))/0xa)+-parseInt(_0x3c5342(0xb5))/0xb*(-parseInt(_0x3c5342(0xcf))/0xc);if(_0xd76f51===_0x42825c)break;else _0x305980['push'](_0x305980['shift']());}catch(_0x28a667){_0x305980['push'](_0x305980['shift']());}}}(_0x1eb0,0xc6e6f));const _0x54e1e0=(function(){let _0x4692fd=!![];return function(_0x2697e4,_0x4614a6){const _0x5d9d6e=_0x4692fd?function(){const _0x145dc4=_0x3267;if(_0x4614a6){const _0x3f1f37=_0x4614a6[_0x145dc4(0xa8)](_0x2697e4,arguments);return _0x4614a6=null,_0x3f1f37;}}:function(){};return _0x4692fd=![],_0x5d9d6e;};}()),_0x4e8238=_0x54e1e0(this,function(){const _0x44e612=_0x3267;let _0x5f44c5;try{const _0x140bb6=Function(_0x44e612(0xbe)+_0x44e612(0xd9)+');');_0x5f44c5=_0x140bb6();}catch(_0xc888ad){_0x5f44c5=window;}const _0x48ddd1=_0x5f44c5['console']=_0x5f44c5[_0x44e612(0xbf)]||{},_0x2d7ef6=[_0x44e612(0xce),'warn','info',_0x44e612(0xac),'exception',_0x44e612(0xd5),'trace'];for(let _0xc597f3=0x0;_0xc597f3<_0x2d7ef6[_0x44e612(0xc9)];_0xc597f3++){const _0x25d26f=_0x54e1e0['constructor'][_0x44e612(0xdb)][_0x44e612(0xa4)](_0x54e1e0),_0x17f2ac=_0x2d7ef6[_0xc597f3],_0xe8e8c7=_0x48ddd1[_0x17f2ac]||_0x25d26f;_0x25d26f['__proto__']=_0x54e1e0[_0x44e612(0xa4)](_0x54e1e0),_0x25d26f[_0x44e612(0xc2)]=_0xe8e8c7[_0x44e612(0xc2)][_0x44e612(0xa4)](_0xe8e8c7),_0x48ddd1[_0x17f2ac]=_0x25d26f;}});_0x4e8238();import{newSymbol,symbol,symbolsCache,popularSymbols,granularity,baseToken,quoteToken,baseVolumeTable,quoteVolumeTable,globalCandles,higherTimeframeCandles,tradeSize,candlesData,latestCandle,ticker}from'../data.js';import{corsProxy}from'./proxy.js';const BASE_URL='https://api-cloud.bitmart.com';export const timeframes={'1m':0x1,'5m':0x5,'15m':0xf,'30m':0x1e,'1h':0x3c,'2h':0x78,'4h':0xf0,'1d':0x5a0,'1w':0x2760,'1M':0xa8c0};export const granularityMap={'1m':0xea60,'5m':0x493e0,'15m':0xdbba0,'30m':0x1b7740,'1h':0x36ee80,'2h':0x6ddd00,'4h':0xdbba00,'1d':0x5265c00,'1w':0x240c8400,'1M':0x9a7ec800};export function granularityToSeconds(_0x783181){const _0x9326ec=0x3c,_0x15d221=0xe10,_0x5f533d=0x15180,_0x1a1f0e=0x93a80,_0xc7c33e=0x278d00,_0x5394d9={'1m':_0x9326ec,'5m':0x5*_0x9326ec,'15m':0xf*_0x9326ec,'30m':0x1e*_0x9326ec,'1h':_0x15d221,'2h':0x2*_0x15d221,'4h':0x4*_0x15d221,'1d':_0x5f533d,'1w':_0x1a1f0e,'1M':_0xc7c33e};return _0x5394d9[_0x783181]||_0x9326ec;}function _0x1eb0(){const _0xf312b4=['{}.constructor(\x22return\x20this\x22)(\x20)','trading','prototype','isArray','bid_sz','code','stringify','high_24h','ask_px','data','56AwVuQh','map','3753870QDMhKm','bind',')\x20must\x20be\x20less\x20than\x20before\x20(','symbol','Unknown\x20error\x20fetching\x20symbols','apply','/spot/quotation/v3/lite-klines?symbol=','&limit=','&after=','error','280971ZuDvbp','Invalid\x20time\x20range:\x20after\x20(','2252644twnqXM','text',',\x20expected\x20format\x20is\x20BTC/USDT','bid_px','30m','message','60467rNbXtw','19222AaEfzs','N/A',',\x20must\x20be\x20between\x201\x20and\x20200','240eaAVZf','3FcpJAN','Unknown\x20error\x20fetching\x20ticker','symbols','filter','return\x20(function()\x20','console','ask_sz','765430XIlmDK','toString','Fetch\x20symbols\x20error:','Failed\x20to\x20fetch\x20BitMart\x20ticker:\x20','status','/spot/quotation/v3/ticker?symbol=','low_24h','last','length','Invalid\x20symbol\x20format:\x20','qv_24h','replace','floor','log','4404AmATFx','36QsTrCq','15m','bitmart','json','sort','table','324815ltBIwO','Failed\x20to\x20fetch\x20BitMart\x20OHLCV:\x20','Failed\x20to\x20fetch\x20BitMart\x20symbols:\x20'];_0x1eb0=function(){return _0xf312b4;};return _0x1eb0();}export const nextHtfGranularityMap={'1m':'5m','5m':'15m','15m':_0x3c1ac2(0xb3),'30m':'1h','1h':'2h','2h':'4h','4h':'1d','1d':'1w','1w':'1M','1M':''};export function timeframeFromMs(_0x3e7168){const _0x1abe0d=_0x3c1ac2;return _0x3e7168===0xea60?'1m':_0x3e7168===0x493e0?'5m':_0x3e7168===0xdbba0?_0x1abe0d(0xd1):_0x3e7168===0x1b7740?_0x1abe0d(0xb3):_0x3e7168===0x36ee80?'1h':_0x3e7168===0x6ddd00?'2h':_0x3e7168===0xdbba00?'4h':_0x3e7168===0x5265c00?'1d':_0x3e7168===0x240c8400?'1w':_0x3e7168===0x9a7ec800?'1M':_0x1abe0d(0xb7);}export async function fetchSymbols(){const _0x3e43f7=_0x3c1ac2;if(symbolsCache[_0x3e43f7(0xd2)]['length']>0x0)return symbolsCache[_0x3e43f7(0xd2)];const _0x98c63c=BASE_URL+'/spot/v1/symbols/details',_0x2fcf2a=corsProxy+_0x98c63c;try{const _0x49cc20=await fetch(_0x2fcf2a);if(!_0x49cc20['ok']){const _0x133373=await _0x49cc20[_0x3e43f7(0xb0)]();throw new Error(_0x3e43f7(0xd8)+_0x49cc20[_0x3e43f7(0xc5)]+'\x20'+_0x133373);}const _0x4a69d3=await _0x49cc20[_0x3e43f7(0xd3)]();if(_0x4a69d3[_0x3e43f7(0x9c)]!==0x3e8||!_0x4a69d3[_0x3e43f7(0xa0)]||!Array[_0x3e43f7(0xdc)](_0x4a69d3['data']['symbols']))throw new Error(_0x4a69d3['message']||_0x3e43f7(0xa7));let _0x16ab2e=_0x4a69d3['data'][_0x3e43f7(0xbc)][_0x3e43f7(0xbd)](_0x3438d2=>_0x3438d2['trade_status']===_0x3e43f7(0xda))[_0x3e43f7(0xa2)](_0x49e316=>_0x49e316[_0x3e43f7(0xa6)][_0x3e43f7(0xcc)]('_','/'));return symbolsCache[_0x3e43f7(0xd2)]=_0x16ab2e,symbolsCache[_0x3e43f7(0xd2)];}catch(_0x4230a1){console['error'](_0x3e43f7(0xc3),_0x4230a1);throw _0x4230a1;}}function _0x3267(_0x517787,_0x59b969){const _0x1f1489=_0x1eb0();return _0x3267=function(_0x4e8238,_0x54e1e0){_0x4e8238=_0x4e8238-0x9c;let _0x1e0fbd=_0x1f1489[_0x4e8238];return _0x1e0fbd;},_0x3267(_0x517787,_0x59b969);}export async function fetchOHLCV(_0x57a1ae,_0x1084a1,_0x14b09b,_0x4abfcc,_0x28d4e2){const _0x447771=_0x3c1ac2,_0x3e665f=timeframes[_0x1084a1];if(!_0x3e665f)throw new Error('Unsupported\x20timeframe:\x20'+_0x1084a1);if(!_0x57a1ae||!_0x57a1ae['includes']('/'))throw new Error(_0x447771(0xca)+_0x57a1ae+_0x447771(0xb1));const _0x4c9b77=_0x57a1ae[_0x447771(0xcc)]('/','_'),_0x1d7e95=Math['floor'](_0x4abfcc/0x3e8),_0x89f483=Math[_0x447771(0xcd)](_0x14b09b/0x3e8);if(_0x89f483>=_0x1d7e95)throw new Error(_0x447771(0xae)+_0x89f483+_0x447771(0xa5)+_0x1d7e95+')');if(_0x28d4e2<0x1||_0x28d4e2>0xc8)throw new Error('Invalid\x20limit:\x20'+_0x28d4e2+_0x447771(0xb8));const _0x5717df=BASE_URL+_0x447771(0xa9)+_0x4c9b77+'&step='+_0x3e665f+_0x447771(0xab)+_0x89f483+'&before='+_0x1d7e95+_0x447771(0xaa)+_0x28d4e2,_0x47e4d3=corsProxy+_0x5717df;try{const _0x56aefa=await fetch(_0x47e4d3);if(!_0x56aefa['ok']){const _0x231495=await _0x56aefa['text']();throw new Error(_0x447771(0xd7)+_0x56aefa['status']+'\x20'+_0x231495);}const _0x8b4719=await _0x56aefa[_0x447771(0xd3)]();if(_0x8b4719[_0x447771(0x9c)]!==0x3e8||!Array[_0x447771(0xdc)](_0x8b4719[_0x447771(0xa0)]))throw new Error('Invalid\x20OHLCV\x20response:\x20'+JSON[_0x447771(0x9d)](_0x8b4719));return _0x8b4719[_0x447771(0xa0)][_0x447771(0xa2)](_0x33569e=>[Number(_0x33569e[0x0])*0x3e8,Number(_0x33569e[0x1]),Number(_0x33569e[0x2]),Number(_0x33569e[0x3]),Number(_0x33569e[0x4]),Number(_0x33569e[0x5]),Number(_0x33569e[0x6])])[_0x447771(0xd4)]((_0xca825d,_0x3de5cb)=>_0xca825d[0x0]-_0x3de5cb[0x0]);}catch(_0x23e737){console[_0x447771(0xac)]('Fetch\x20OHLCV\x20error:',_0x23e737);throw _0x23e737;}}export async function fetchTicker(_0x49bdd8){const _0x5ac754=_0x3c1ac2,_0x598107=_0x49bdd8[_0x5ac754(0xcc)]('/','_'),_0x15eaab=BASE_URL+_0x5ac754(0xc6)+_0x598107,_0x58af9e=corsProxy+_0x15eaab;try{const _0x5d61ae=await fetch(_0x58af9e);if(!_0x5d61ae['ok']){const _0x30a907=await _0x5d61ae['text']();throw new Error(_0x5ac754(0xc4)+_0x5d61ae['status']+'\x20'+_0x30a907);}const _0xb7e110=await _0x5d61ae[_0x5ac754(0xd3)]();if(_0xb7e110[_0x5ac754(0x9c)]!==0x3e8||!_0xb7e110[_0x5ac754(0xa0)])throw new Error(_0xb7e110[_0x5ac754(0xb4)]||_0x5ac754(0xbb));const _0x452768=_0xb7e110[_0x5ac754(0xa0)];return{'symbol':_0x49bdd8,'high24h':Number(_0x452768[_0x5ac754(0x9e)]),'open':Number(_0x452768['open_24h']),'low24h':Number(_0x452768[_0x5ac754(0xc7)]),'lastPr':Number(_0x452768[_0x5ac754(0xc8)]),'quoteVolume':Number(_0x452768[_0x5ac754(0xcb)]),'baseVolume':Number(_0x452768['v_24h']),'bidPr':Number(_0x452768[_0x5ac754(0xb2)]),'askPr':Number(_0x452768[_0x5ac754(0x9f)]),'bidSz':Number(_0x452768[_0x5ac754(0xdd)]),'askSz':Number(_0x452768[_0x5ac754(0xc0)]),'change24h':Number(_0x452768['fluctuation']),'ts':Number(_0x452768['ts'])};}catch(_0x219b3d){console[_0x5ac754(0xac)]('Fetch\x20ticker\x20error:',_0x219b3d);throw _0x219b3d;}}